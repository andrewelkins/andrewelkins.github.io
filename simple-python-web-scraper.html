<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="I needed a simple html only scraper. (This doesn&#39;t use js, won&#39;t pull down data via AJAX). I found an example on another site, thetaranights.com, but it wasn&#39;t exactly what I needed. It only...">
        <meta name="keywords" content="">
        <link rel="icon" href="https://andrewelkins.com/favicon.ico">

        <title>Simple Python Web Scraper - Andrew Elkins</title>

        <!-- Stylesheets -->
        <link href="https://andrewelkins.com/theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://andrewelkins.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Andrew Elkins Full Atom Feed" />
        <link href="https://andrewelkins.com/feeds/linux-php-programming-python.atom.xml" type="application/atom+xml" rel="alternate" title="Andrew Elkins Categories Atom Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="https://andrewelkins.com/"><img class="mr20" src="https://andrewelkins.com/image/logo.png" alt="logo">Andrew Elkins</a>
                    </div>
                    <div class="nav pull-right">
                                <a href="https://andrewelkins.com/">Homepage</a>
                                <a href="https://andrewelkins.com/categories.html">Categories</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">Simple Python Web Scraper</h1>
                      <p class="header-date">By <a href="https://andrewelkins.com/author/andrew-elkins.html">Andrew Elkins</a>, Mon 22 February 2016, in category <a href="https://andrewelkins.com/category/linux-php-programming-python.html">Linux, php, programming, python</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <p>I needed a simple html only scraper. (This doesn't use js, won't pull
down data via AJAX). I found an example on another site,
<a href="http://www.thetaranights.com/web-mining-login-to-any-website-using-mechanize-module-in-python/">thetaranights.com</a>,
but it wasn't exactly what I needed. It only pulled the data and printed
it to screen. I added a list to loop through and auto saving by url name
to a html file.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mechanize</span> \<span class="c1">#pip install mechanize</span>

<span class="n">br</span> <span class="o">=</span> <span class="n">mechanize</span><span class="o">.</span><span class="n">Browser</span><span class="p">()</span>  
<span class="n">br</span><span class="o">.</span><span class="n">set</span>\<span class="n">_handle</span>\<span class="n">_robots</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>  
<span class="n">br</span><span class="o">.</span><span class="n">addheaders</span> <span class="o">=</span> \<span class="p">[(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">User</span><span class="o">-</span><span class="n">agent</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Mozilla</span><span class="o">/</span><span class="mf">5.0</span> <span class="p">(</span><span class="n">X11</span><span class="p">;</span> <span class="n">U</span><span class="p">;</span>
<span class="n">Linux</span> <span class="n">i686</span><span class="p">;</span> <span class="n">en</span><span class="o">-</span><span class="n">US</span><span class="p">;</span> <span class="n">rv</span><span class="p">:</span><span class="mf">1.9</span><span class="o">.</span><span class="mf">2.13</span><span class="p">)</span> <span class="n">Gecko</span><span class="o">/</span><span class="mi">20101206</span> <span class="n">Ubuntu</span><span class="o">/</span><span class="mf">10.10</span> <span class="p">(</span><span class="n">maverick</span><span class="p">)</span>
<span class="n">Firefox</span><span class="o">/</span><span class="mf">3.6</span><span class="o">.</span><span class="mi">13</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>\<span class="p">]</span>

<span class="n">sign</span>\<span class="n">_in</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">this</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">login</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span> \<span class="c1">#the</span>
<span class="n">login</span> <span class="n">url</span>

<span class="n">br</span><span class="o">.</span><span class="n">select</span>\<span class="n">_form</span><span class="p">(</span><span class="n">nr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> \<span class="c1">#accessing form by their index. Since we have</span>
<span class="n">only</span> <span class="n">one</span> <span class="n">form</span> <span class="ow">in</span> <span class="n">this</span> <span class="n">example</span><span class="p">,</span> <span class="n">nr</span> <span class="o">=</span><span class="mf">0.</span>  
\<span class="c1">#br.select\_form(name = &amp;quot;form name&amp;quot;) Alternatively you may</span>
<span class="n">use</span> <span class="n">this</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">line</span> <span class="k">if</span> <span class="n">your</span> <span class="n">form</span> <span class="n">has</span> <span class="n">name</span> <span class="n">attribute</span>
<span class="n">available</span><span class="o">.</span>

<span class="n">br</span>\<span class="p">[</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">email</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span>\<span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">email</span> <span class="ow">or</span> <span class="n">username</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> \<span class="c1">#the key</span>
<span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">username</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">variable</span> <span class="n">that</span> <span class="n">takes</span> <span class="n">the</span> <span class="n">username</span><span class="o">/</span><span class="n">email</span> <span class="n">value</span>

<span class="n">br</span>\<span class="p">[</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">password</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span>\<span class="p">]</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">password</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> \<span class="c1">#the key</span>
<span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">password</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">variable</span> <span class="n">that</span> <span class="n">takes</span> <span class="n">the</span> <span class="n">password</span> <span class="n">value</span>

<span class="n">logged</span>\<span class="n">_in</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span> \<span class="c1">#submitting the login credentials</span>

<span class="n">logincheck</span> <span class="o">=</span> <span class="n">logged</span>\<span class="n">_in</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> \<span class="c1">#reading the page body that is</span>
<span class="n">redirected</span> <span class="n">after</span> <span class="n">successful</span> <span class="n">login</span>

<span class="n">urls</span> <span class="o">=</span>
\<span class="p">[</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">this</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">page</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">this</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">some</span><span class="o">/</span><span class="n">page2</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span>\<span class="p">]</span>

<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>  
<span class="n">req</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  
<span class="n">filename</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>\<span class="p">[</span><span class="o">-</span><span class="mi">1</span>\<span class="p">]</span> <span class="o">+</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">.</span><span class="n">html</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span>  
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>  
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>  
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>


<p>Which produces 2 files:<br>
page.html<br>
page2.html</p>


        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="https://andrewelkins.com/archives.html">Archives</a></li>
                            <li><a href="https://andrewelkins.com/tags.html">Tags</a></li>
                            <li><a href="https://andrewelkins.com/authors.html">Authors</a></li>
                            <li><a href="https://andrewelkins.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Social</div>
                        <ul class="list-unstyled">
                            <li><a href="#" target="_blank">You can add links in your config file</a></li>
                            <li><a href="#" target="_blank">Another social link</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Links</div>
                        <ul class="list-unstyled">
                            <li><a href="http://getpelican.com/" target="_blank">Pelican</a></li>
                            <li><a href="http://python.org/" target="_blank">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a></li>
                            <li><a href="#" target="_blank">You can modify those links in your config file</a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; Andrew Elkins 2008-2018</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>